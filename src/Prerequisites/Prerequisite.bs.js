// Generated by BUCKLESCRIPT, PLEASE EDIT WITH CARE

import * as Curry from "bs-platform/lib/es6/curry.js";
import * as Json_decode from "@glennsl/bs-json/src/Json_decode.bs.js";
import * as Id$OptolithClient from "../Misc/Id.bs.js";
import * as Chars$OptolithClient from "../Utilities/Chars.bs.js";
import * as Ley_Ix$OptolithClient from "../Data/Ley_Ix.bs.js";
import * as Ley_Int$OptolithClient from "../Data/Ley_Int.bs.js";
import * as Ley_List$OptolithClient from "../Data/Ley_List.bs.js";
import * as JsonStrict$OptolithClient from "../Misc/JsonStrict.bs.js";
import * as Ley_IntMap$OptolithClient from "../Data/Ley_IntMap.bs.js";
import * as Ley_Option$OptolithClient from "../Data/Ley_Option.bs.js";
import * as Ley_Function$OptolithClient from "../Data/Ley_Function.bs.js";
import * as TranslationMap$OptolithClient from "../Misc/TranslationMap.bs.js";

function partial_arg_0(param) {
  return Json_decode.map((function (id) {
                return {
                        TAG: /* One */0,
                        _0: id
                      };
              }), Json_decode.$$int, param);
}

var partial_arg_1 = {
  hd: (function (param) {
      return Json_decode.map((function (id) {
                    return {
                            TAG: /* Many */1,
                            _0: id
                          };
                  }), (function (param) {
                    return Json_decode.list(Json_decode.$$int, param);
                  }), param);
    }),
  tl: /* [] */0
};

var partial_arg = {
  hd: partial_arg_0,
  tl: partial_arg_1
};

function oneOrManyInt(param) {
  return Json_decode.oneOf(partial_arg, param);
}

function decode(json) {
  var str = Json_decode.string(json);
  switch (str) {
    case "f" :
        return /* Female */1;
    case "m" :
        return /* Male */0;
    default:
      throw {
            RE_EXN_ID: Json_decode.DecodeError,
            _1: "Unknown sex prerequisite: " + str,
            Error: new Error()
          };
  }
}

var Sex = {
  decode: decode
};

function partial_arg_0$1(json) {
  return {
          id: oneOrManyInt(json),
          active: true
        };
}

var partial_arg_1$1 = {
  hd: (function (json) {
      return {
              id: Json_decode.field("id", oneOrManyInt, json),
              active: Json_decode.field("active", Json_decode.bool, json)
            };
    }),
  tl: /* [] */0
};

var partial_arg$1 = {
  hd: partial_arg_0$1,
  tl: partial_arg_1$1
};

function decode$1(param) {
  return Json_decode.oneOf(partial_arg$1, param);
}

var Race = {
  decode: decode$1
};

var Culture = {
  decode: oneOrManyInt
};

var SocialStatus = {
  decode: Json_decode.$$int
};

function decode$2(json) {
  return {
          category: JsonStrict$OptolithClient.field("category", JsonStrict$OptolithClient.$$int, json),
          domain: JsonStrict$OptolithClient.optionalField("domain", oneOrManyInt, json),
          level: JsonStrict$OptolithClient.optionalField("level", JsonStrict$OptolithClient.$$int, json)
        };
}

var Pact = {
  decode: decode$2
};

function decode$3(json) {
  var str = Json_decode.field("type", Json_decode.string, json);
  var tmp;
  switch (str) {
    case "blessed" :
        tmp = /* Blessed */1;
        break;
    case "magical" :
        tmp = /* Magical */0;
        break;
    default:
      throw {
            RE_EXN_ID: Json_decode.DecodeError,
            _1: "Unknown primary attribute type: " + str,
            Error: new Error()
          };
  }
  return {
          value: Json_decode.field("value", Json_decode.$$int, json),
          scope: tmp
        };
}

var PrimaryAttribute = {
  decode: decode$3
};

function decode$4(json) {
  return {
          id: JsonStrict$OptolithClient.field("id", Id$OptolithClient.Activatable.Decode.t, json),
          active: JsonStrict$OptolithClient.field("active", JsonStrict$OptolithClient.bool, json),
          options: JsonStrict$OptolithClient.field("options", (function (param) {
                  return JsonStrict$OptolithClient.list(Id$OptolithClient.Activatable.SelectOption.Decode.t, param);
                }), json),
          level: JsonStrict$OptolithClient.optionalField("level", JsonStrict$OptolithClient.$$int, json)
        };
}

var Activatable = {
  decode: decode$4
};

function decodeList(f, json) {
  return Curry._1(f, Json_decode.field("value", (function (param) {
                    return Json_decode.list(Json_decode.$$int, param);
                  }), json));
}

function decodeIds(param) {
  return Json_decode.andThen((function (str) {
                switch (str) {
                  case "Advantage" :
                      return function (param) {
                        return decodeList((function (xs) {
                                      return {
                                              TAG: /* Advantages */0,
                                              _0: xs
                                            };
                                    }), param);
                      };
                  case "Disadvantage" :
                      return function (param) {
                        return decodeList((function (xs) {
                                      return {
                                              TAG: /* Disadvantages */1,
                                              _0: xs
                                            };
                                    }), param);
                      };
                  case "SpecialAbility" :
                      return function (param) {
                        return decodeList((function (xs) {
                                      return {
                                              TAG: /* SpecialAbilities */2,
                                              _0: xs
                                            };
                                    }), param);
                      };
                  default:
                    throw {
                          RE_EXN_ID: Json_decode.DecodeError,
                          _1: "Unknown activatable ID scope: " + str,
                          Error: new Error()
                        };
                }
              }), (function (param) {
                return Json_decode.field("scope", Json_decode.string, param);
              }), param);
}

function decode$5(json) {
  return {
          id: JsonStrict$OptolithClient.field("id", decodeIds, json),
          active: JsonStrict$OptolithClient.field("active", JsonStrict$OptolithClient.bool, json),
          options: JsonStrict$OptolithClient.field("options", (function (param) {
                  return JsonStrict$OptolithClient.list(Id$OptolithClient.Activatable.SelectOption.Decode.t, param);
                }), json),
          level: JsonStrict$OptolithClient.optionalField("level", JsonStrict$OptolithClient.$$int, json)
        };
}

function decode$6(json) {
  return {
          id: JsonStrict$OptolithClient.field("id", Id$OptolithClient.Activatable.Decode.t, json),
          active: JsonStrict$OptolithClient.field("active", JsonStrict$OptolithClient.bool, json),
          firstOption: JsonStrict$OptolithClient.field("firstOption", (function (param) {
                  return JsonStrict$OptolithClient.list(Id$OptolithClient.Activatable.SelectOption.Decode.t, param);
                }), json),
          otherOptions: JsonStrict$OptolithClient.field("otherOptions", (function (param) {
                  return JsonStrict$OptolithClient.list(Id$OptolithClient.Activatable.SelectOption.Decode.t, param);
                }), json),
          level: JsonStrict$OptolithClient.optionalField("level", JsonStrict$OptolithClient.$$int, json)
        };
}

var ActivatableMultiSelect = {
  decode: decode$6
};

function decode$7(json) {
  return {
          id: Json_decode.field("id", Id$OptolithClient.Increasable.Decode.t, json),
          value: Json_decode.field("value", Json_decode.$$int, json)
        };
}

var Increasable = {
  decode: decode$7
};

function decodeList$1(f, json) {
  return Curry._1(f, Json_decode.field("value", (function (param) {
                    return Json_decode.list(Json_decode.$$int, param);
                  }), json));
}

function decodeIds$1(param) {
  return Json_decode.andThen((function (str) {
                switch (str) {
                  case "Attribute" :
                      return function (param) {
                        return decodeList$1((function (xs) {
                                      return {
                                              TAG: /* Attributes */0,
                                              _0: xs
                                            };
                                    }), param);
                      };
                  case "CombatTechnique" :
                      return function (param) {
                        return decodeList$1((function (xs) {
                                      return {
                                              TAG: /* CombatTechniques */2,
                                              _0: xs
                                            };
                                    }), param);
                      };
                  case "LiturgicalChant" :
                      return function (param) {
                        return decodeList$1((function (xs) {
                                      return {
                                              TAG: /* LiturgicalChants */4,
                                              _0: xs
                                            };
                                    }), param);
                      };
                  case "Skill" :
                      return function (param) {
                        return decodeList$1((function (xs) {
                                      return {
                                              TAG: /* Skills */1,
                                              _0: xs
                                            };
                                    }), param);
                      };
                  case "Spell" :
                      return function (param) {
                        return decodeList$1((function (xs) {
                                      return {
                                              TAG: /* Spells */3,
                                              _0: xs
                                            };
                                    }), param);
                      };
                  default:
                    throw {
                          RE_EXN_ID: Json_decode.DecodeError,
                          _1: "Unknown increasable ID scope: " + str,
                          Error: new Error()
                        };
                }
              }), (function (param) {
                return Json_decode.field("scope", Json_decode.string, param);
              }), param);
}

function decode$8(json) {
  return {
          id: Json_decode.field("id", decodeIds$1, json),
          value: Json_decode.field("value", Json_decode.$$int, json)
        };
}

var Translation = {
  decode: Json_decode.string
};

var TranslationMap = TranslationMap$OptolithClient.Make(Translation);

function decodeMultilingual(json) {
  return Ley_Option$OptolithClient.fromOption(/* MultilingualGenerate */0, JsonStrict$OptolithClient.optionalField("displayOption", (function (param) {
                    return JsonStrict$OptolithClient.andThen((function (str) {
                                  switch (str) {
                                    case "ByLevel" :
                                        return function (json) {
                                          return /* MultilingualReplaceWith */{
                                                  _0: JsonStrict$OptolithClient.field("value", TranslationMap.decode, json)
                                                };
                                        };
                                    case "Hide" :
                                        return function (param) {
                                          return /* MultilingualHide */1;
                                        };
                                    default:
                                      throw {
                                            RE_EXN_ID: JsonStrict$OptolithClient.DecodeError,
                                            _1: "Unknown display option type: " + str,
                                            Error: new Error()
                                          };
                                  }
                                }), (function (param) {
                                  return JsonStrict$OptolithClient.field("type", JsonStrict$OptolithClient.string, param);
                                }), param);
                  }), json));
}

function resolveTranslations(langs, x) {
  if (typeof x === "number") {
    if (x !== 0) {
      return /* Hide */1;
    } else {
      return /* Generate */0;
    }
  } else {
    return /* ReplaceWith */{
            _0: Ley_Option$OptolithClient.fromOption(Chars$OptolithClient.mdash, Curry._2(TranslationMap.getFromLanguageOrder, langs, x._0))
          };
  }
}

function decodeMultilingual$1(decoder, wrap, json) {
  return {
          value: Curry._1(wrap, Json_decode.field("value", decoder, json)),
          displayOption: decodeMultilingual(json)
        };
}

function resolveTranslations$1(langs, param) {
  return {
          value: param.value,
          displayOption: resolveTranslations(langs, param.displayOption)
        };
}

function decodeMultilingual$2(param) {
  return Json_decode.andThen((function (str) {
                switch (str) {
                  case "Activatable" :
                      return function (param) {
                        return decodeMultilingual$1(decode$4, (function (v) {
                                      return {
                                              TAG: /* Activatable */6,
                                              _0: v
                                            };
                                    }), param);
                      };
                  case "ActivatableMultiEntry" :
                      return function (param) {
                        return decodeMultilingual$1(decode$5, (function (v) {
                                      return {
                                              TAG: /* ActivatableMultiEntry */7,
                                              _0: v
                                            };
                                    }), param);
                      };
                  case "ActivatableMultiSelect" :
                      return function (param) {
                        return decodeMultilingual$1(decode$6, (function (v) {
                                      return {
                                              TAG: /* ActivatableMultiSelect */8,
                                              _0: v
                                            };
                                    }), param);
                      };
                  case "Culture" :
                      return function (param) {
                        return decodeMultilingual$1(oneOrManyInt, (function (v) {
                                      return {
                                              TAG: /* Culture */2,
                                              _0: v
                                            };
                                    }), param);
                      };
                  case "Increasable" :
                      return function (param) {
                        return decodeMultilingual$1(decode$7, (function (v) {
                                      return {
                                              TAG: /* Increasable */9,
                                              _0: v
                                            };
                                    }), param);
                      };
                  case "IncreasableMultiEntry" :
                      return function (param) {
                        return decodeMultilingual$1(decode$8, (function (v) {
                                      return {
                                              TAG: /* IncreasableMultiEntry */10,
                                              _0: v
                                            };
                                    }), param);
                      };
                  case "Pact" :
                      return function (param) {
                        return decodeMultilingual$1(decode$2, (function (v) {
                                      return {
                                              TAG: /* Pact */3,
                                              _0: v
                                            };
                                    }), param);
                      };
                  case "PrimaryAttribute" :
                      return function (param) {
                        return decodeMultilingual$1(decode$3, (function (v) {
                                      return {
                                              TAG: /* PrimaryAttribute */5,
                                              _0: v
                                            };
                                    }), param);
                      };
                  case "Race" :
                      return function (param) {
                        return decodeMultilingual$1(decode$1, (function (v) {
                                      return {
                                              TAG: /* Race */1,
                                              _0: v
                                            };
                                    }), param);
                      };
                  case "Sex" :
                      return function (param) {
                        return decodeMultilingual$1(decode, (function (v) {
                                      return {
                                              TAG: /* Sex */0,
                                              _0: v
                                            };
                                    }), param);
                      };
                  case "SocialStatus" :
                      return function (param) {
                        return decodeMultilingual$1(Json_decode.$$int, (function (v) {
                                      return {
                                              TAG: /* SocialStatus */4,
                                              _0: v
                                            };
                                    }), param);
                      };
                  default:
                    throw {
                          RE_EXN_ID: Json_decode.DecodeError,
                          _1: "Unknown prerequisite type: " + str,
                          Error: new Error()
                        };
                }
              }), (function (param) {
                return Json_decode.field("type", Json_decode.string, param);
              }), param);
}

var General = {
  decodeMultilingual: decodeMultilingual$2,
  resolveTranslations: resolveTranslations$1
};

function decodeMultilingual$3(param) {
  return Json_decode.andThen((function (str) {
                switch (str) {
                  case "Activatable" :
                      return function (param) {
                        return decodeMultilingual$1(decode$4, (function (v) {
                                      return {
                                              TAG: /* Activatable */3,
                                              _0: v
                                            };
                                    }), param);
                      };
                  case "Culture" :
                      return function (param) {
                        return decodeMultilingual$1(oneOrManyInt, (function (v) {
                                      return {
                                              TAG: /* Culture */2,
                                              _0: v
                                            };
                                    }), param);
                      };
                  case "Increasable" :
                      return function (param) {
                        return decodeMultilingual$1(decode$7, (function (v) {
                                      return {
                                              TAG: /* Increasable */4,
                                              _0: v
                                            };
                                    }), param);
                      };
                  case "Race" :
                      return function (param) {
                        return decodeMultilingual$1(decode$1, (function (v) {
                                      return {
                                              TAG: /* Race */1,
                                              _0: v
                                            };
                                    }), param);
                      };
                  case "Sex" :
                      return function (param) {
                        return decodeMultilingual$1(decode, (function (v) {
                                      return {
                                              TAG: /* Sex */0,
                                              _0: v
                                            };
                                    }), param);
                      };
                  default:
                    throw {
                          RE_EXN_ID: Json_decode.DecodeError,
                          _1: "Unknown prerequisite type: " + str,
                          Error: new Error()
                        };
                }
              }), (function (param) {
                return Json_decode.field("type", Json_decode.string, param);
              }), param);
}

var Profession = {
  decodeMultilingual: decodeMultilingual$3,
  resolveTranslations: resolveTranslations$1
};

function decodeMultilingual$4(param) {
  return Json_decode.andThen((function (str) {
                switch (str) {
                  case "Activatable" :
                      return function (param) {
                        return decodeMultilingual$1(decode$4, (function (v) {
                                      return {
                                              TAG: /* Activatable */6,
                                              _0: v
                                            };
                                    }), param);
                      };
                  case "ActivatableMultiEntry" :
                      return function (param) {
                        return decodeMultilingual$1(decode$5, (function (v) {
                                      return {
                                              TAG: /* ActivatableMultiEntry */7,
                                              _0: v
                                            };
                                    }), param);
                      };
                  case "ActivatableMultiSelect" :
                      return function (param) {
                        return decodeMultilingual$1(decode$6, (function (v) {
                                      return {
                                              TAG: /* ActivatableMultiSelect */8,
                                              _0: v
                                            };
                                    }), param);
                      };
                  case "CommonSuggestedByRCP" :
                      return function (param) {
                        return {
                                value: /* CommonSuggestedByRCP */0,
                                displayOption: /* MultilingualGenerate */0
                              };
                      };
                  case "Culture" :
                      return function (param) {
                        return decodeMultilingual$1(oneOrManyInt, (function (v) {
                                      return {
                                              TAG: /* Culture */2,
                                              _0: v
                                            };
                                    }), param);
                      };
                  case "Increasable" :
                      return function (param) {
                        return decodeMultilingual$1(decode$7, (function (v) {
                                      return {
                                              TAG: /* Increasable */9,
                                              _0: v
                                            };
                                    }), param);
                      };
                  case "IncreasableMultiEntry" :
                      return function (param) {
                        return decodeMultilingual$1(decode$8, (function (v) {
                                      return {
                                              TAG: /* IncreasableMultiEntry */10,
                                              _0: v
                                            };
                                    }), param);
                      };
                  case "Pact" :
                      return function (param) {
                        return decodeMultilingual$1(decode$2, (function (v) {
                                      return {
                                              TAG: /* Pact */3,
                                              _0: v
                                            };
                                    }), param);
                      };
                  case "PrimaryAttribute" :
                      return function (param) {
                        return decodeMultilingual$1(decode$3, (function (v) {
                                      return {
                                              TAG: /* PrimaryAttribute */5,
                                              _0: v
                                            };
                                    }), param);
                      };
                  case "Race" :
                      return function (param) {
                        return decodeMultilingual$1(decode$1, (function (v) {
                                      return {
                                              TAG: /* Race */1,
                                              _0: v
                                            };
                                    }), param);
                      };
                  case "Sex" :
                      return function (param) {
                        return decodeMultilingual$1(decode, (function (v) {
                                      return {
                                              TAG: /* Sex */0,
                                              _0: v
                                            };
                                    }), param);
                      };
                  case "SocialStatus" :
                      return function (param) {
                        return decodeMultilingual$1(Json_decode.$$int, (function (v) {
                                      return {
                                              TAG: /* SocialStatus */4,
                                              _0: v
                                            };
                                    }), param);
                      };
                  default:
                    throw {
                          RE_EXN_ID: Json_decode.DecodeError,
                          _1: "Unknown prerequisite type: " + str,
                          Error: new Error()
                        };
                }
              }), (function (param) {
                return Json_decode.field("type", Json_decode.string, param);
              }), param);
}

var AdvantageDisadvantage = {
  decodeMultilingual: decodeMultilingual$4,
  resolveTranslations: resolveTranslations$1
};

function decodeMultilingual$5(decoder) {
  return function (param) {
    return Json_decode.andThen((function (str) {
                  switch (str) {
                    case "ByLevel" :
                        return function (json) {
                          var xs = Json_decode.list((function (json) {
                                  return [
                                          Json_decode.field("level", Json_decode.$$int, json),
                                          Json_decode.field("prerequisites", (function (param) {
                                                  return Json_decode.list(decoder, param);
                                                }), json)
                                        ];
                                }), json);
                          return {
                                  TAG: /* ByLevel */1,
                                  _0: Curry._1(Ley_IntMap$OptolithClient.fromList, xs)
                                };
                        };
                    case "Plain" :
                        return function (json) {
                          return {
                                  TAG: /* Plain */0,
                                  _0: Json_decode.list(decoder, json)
                                };
                        };
                    default:
                      throw {
                            RE_EXN_ID: Json_decode.DecodeError,
                            _1: "Unknown prerequisite list type: " + str,
                            Error: new Error()
                          };
                  }
                }), (function (param) {
                  return Json_decode.field("type", Json_decode.string, param);
                }), param);
  };
}

function resolveTranslations$2(langs, f, x) {
  if (x.TAG) {
    return {
            TAG: /* ByLevel */1,
            _0: Curry._2(Ley_IntMap$OptolithClient.map, Curry._1(Ley_List$OptolithClient.map, Curry._1(f, langs)), x._0)
          };
  } else {
    return {
            TAG: /* Plain */0,
            _0: Curry._2(Ley_List$OptolithClient.map, Curry._1(f, langs), x._0)
          };
  }
}

function getFirstLevel(prerequisites) {
  if (prerequisites.TAG) {
    return Ley_Option$OptolithClient.fromOption(/* [] */0, Curry._2(Ley_IntMap$OptolithClient.lookup, 1, prerequisites._0));
  } else {
    return prerequisites._0;
  }
}

function makeRangePredicate(oldLevel, newLevel) {
  var level;
  if (oldLevel !== undefined) {
    if (newLevel !== undefined) {
      var match = Ley_Int$OptolithClient.minmax(oldLevel, newLevel);
      var partial_arg_0 = match[0] + 1 | 0;
      var partial_arg_1 = match[1];
      var partial_arg = [
        partial_arg_0,
        partial_arg_1
      ];
      return function (param) {
        return Ley_Ix$OptolithClient.inRange(partial_arg, param);
      };
    }
    level = oldLevel;
  } else {
    if (newLevel === undefined) {
      return function (param) {
        return Ley_Function$OptolithClient.$$const(true, param);
      };
    }
    level = newLevel;
  }
  return function (param) {
    return level >= param;
  };
}

function concatRange(oldLevel, newLevel, prerequisites) {
  var pred = makeRangePredicate(oldLevel, newLevel);
  if (prerequisites.TAG) {
    return Curry._1(Ley_IntMap$OptolithClient.IntMap.Foldable.concat, Curry._2(Ley_IntMap$OptolithClient.filterWithKey, (function (k, param) {
                      return Curry._1(pred, k);
                    }), prerequisites._0));
  } else if (Curry._1(pred, 1)) {
    return prerequisites._0;
  } else {
    return /* [] */0;
  }
}

var decodeMultilingual$6 = decodeMultilingual$5(decodeMultilingual$2);

function resolveTranslations$3(langs, x) {
  return resolveTranslations$2(langs, resolveTranslations$1, x);
}

var General$1 = {
  decodeMultilingual: decodeMultilingual$6,
  resolveTranslations: resolveTranslations$3
};

function decodeMultilingual$7(param) {
  return Json_decode.list(decodeMultilingual$3, param);
}

function resolveTranslations$4(langs, x) {
  return Curry._2(Ley_List$OptolithClient.map, Curry._1(resolveTranslations$1, langs), x);
}

var Profession$1 = {
  decodeMultilingual: decodeMultilingual$7,
  resolveTranslations: resolveTranslations$4
};

var decodeMultilingual$8 = decodeMultilingual$5(decodeMultilingual$4);

function resolveTranslations$5(langs, x) {
  return resolveTranslations$2(langs, resolveTranslations$1, x);
}

var AdvantageDisadvantage$1 = {
  decodeMultilingual: decodeMultilingual$8,
  resolveTranslations: resolveTranslations$5
};

var ActivatableMultiEntry = {
  decode: decode$5
};

var IncreasableMultiEntry = {
  decode: decode$8
};

var DisplayOption = {};

var Config = {};

var Collection_ByLevel = {
  getFirstLevel: getFirstLevel,
  concatRange: concatRange
};

var Collection = {
  ByLevel: Collection_ByLevel,
  General: General$1,
  Profession: Profession$1,
  AdvantageDisadvantage: AdvantageDisadvantage$1
};

export {
  oneOrManyInt ,
  Sex ,
  Race ,
  Culture ,
  SocialStatus ,
  Pact ,
  PrimaryAttribute ,
  Activatable ,
  ActivatableMultiEntry ,
  ActivatableMultiSelect ,
  Increasable ,
  IncreasableMultiEntry ,
  DisplayOption ,
  Config ,
  General ,
  Profession ,
  AdvantageDisadvantage ,
  Collection ,
  
}
/* TranslationMap Not a pure module */
