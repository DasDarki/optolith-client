// Generated by BUCKLESCRIPT, PLEASE EDIT WITH CARE

import * as Path from "path";
import * as Yaml from "yaml";
import * as Curry from "bs-platform/lib/es6/curry.js";
import * as Pervasives from "bs-platform/lib/es6/pervasives.js";
import * as IO$OptolithClient from "../Data/IO.bs.js";
import * as Ley_Int$OptolithClient from "../Data/Ley_Int.bs.js";
import * as Ley_List$OptolithClient from "../Data/Ley_List.bs.js";
import * as Directory$OptolithClient from "../Data/Directory.bs.js";

var Parser = {};

function parseUI(locale) {
  return Curry._2(IO$OptolithClient.Infix.$less$amp$great, IO$OptolithClient.readFile(Path.join(".", "src", "Database", "UI", locale + ".yml")), (function (prim) {
                return Yaml.parse(prim);
              }));
}

function parseFilesOfEntryType(dir) {
  return IO$OptolithClient.mapM((function (x) {
                return Curry._2(IO$OptolithClient.Infix.$less$amp$great, IO$OptolithClient.readFile(x), (function (prim) {
                              return Yaml.parse(prim);
                            }));
              }), Directory$OptolithClient.getDirectoryContents(Path.join(".", "src", "Database", dir)));
}

function parseDirectories(onProgress, dirs) {
  var max = Curry._1(Ley_List$OptolithClient.length, dirs);
  return IO$OptolithClient.imapM((function (i, dir) {
                return Curry._2(IO$OptolithClient.Infix.$less$amp$great, parseFilesOfEntryType(dir), (function (res) {
                              Curry._1(onProgress, (i + 1) / max);
                              return res;
                            }));
              }), dirs);
}

var dirs = {
  hd: "Advantages",
  tl: {
    hd: "AnimistForces",
    tl: {
      hd: "ArcaneBardTraditions",
      tl: {
        hd: "ArcaneDancerTraditions",
        tl: {
          hd: "ArmorTypes",
          tl: {
            hd: "Aspects",
            tl: {
              hd: "Attributes",
              tl: {
                hd: "BlessedTraditions",
                tl: {
                  hd: "Blessings",
                  tl: {
                    hd: "Brews",
                    tl: {
                      hd: "Cantrips",
                      tl: {
                        hd: "CombatSpecialAbilityGroups",
                        tl: {
                          hd: "CombatTechniqueGroups",
                          tl: {
                            hd: "CombatTechniques",
                            tl: {
                              hd: "Conditions",
                              tl: {
                                hd: "Cultures",
                                tl: {
                                  hd: "Curses",
                                  tl: {
                                    hd: "DerivedCharacteristics",
                                    tl: {
                                      hd: "Disadvantages",
                                      tl: {
                                        hd: "DominationRituals",
                                        tl: {
                                          hd: "ElvenMagicalSongs",
                                          tl: {
                                            hd: "Items",
                                            tl: {
                                              hd: "EquipmentGroups",
                                              tl: {
                                                hd: "EquipmentPackages",
                                                tl: {
                                                  hd: "ExperienceLevels",
                                                  tl: {
                                                    hd: "EyeColors",
                                                    tl: {
                                                      hd: "FocusRules",
                                                      tl: {
                                                        hd: "GeodeRituals",
                                                        tl: {
                                                          hd: "HairColors",
                                                          tl: {
                                                            hd: "LiturgicalChantGroups",
                                                            tl: {
                                                              hd: "LiturgicalChants",
                                                              tl: {
                                                                hd: "MagicalDances",
                                                                tl: {
                                                                  hd: "MagicalMelodies",
                                                                  tl: {
                                                                    hd: "MagicalTraditions",
                                                                    tl: {
                                                                      hd: "OptionalRules",
                                                                      tl: {
                                                                        hd: "Pacts",
                                                                        tl: {
                                                                          hd: "Professions",
                                                                          tl: {
                                                                            hd: "Properties",
                                                                            tl: {
                                                                              hd: "Publications",
                                                                              tl: {
                                                                                hd: "Races",
                                                                                tl: {
                                                                                  hd: "Reaches",
                                                                                  tl: {
                                                                                    hd: "RogueSpells",
                                                                                    tl: {
                                                                                      hd: "SkillGroups",
                                                                                      tl: {
                                                                                        hd: "Skills",
                                                                                        tl: {
                                                                                          hd: "SocialStatuses",
                                                                                          tl: {
                                                                                            hd: "SpecialAbilities",
                                                                                            tl: {
                                                                                              hd: "SpecialAbilityGroups",
                                                                                              tl: {
                                                                                                hd: "SpellGroups",
                                                                                                tl: {
                                                                                                  hd: "Spells",
                                                                                                  tl: {
                                                                                                    hd: "States",
                                                                                                    tl: {
                                                                                                      hd: "Subjects",
                                                                                                      tl: {
                                                                                                        hd: "Tribes",
                                                                                                        tl: {
                                                                                                          hd: "ZibiljaRituals",
                                                                                                          tl: /* [] */0
                                                                                                        }
                                                                                                      }
                                                                                                    }
                                                                                                  }
                                                                                                }
                                                                                              }
                                                                                            }
                                                                                          }
                                                                                        }
                                                                                      }
                                                                                    }
                                                                                  }
                                                                                }
                                                                              }
                                                                            }
                                                                          }
                                                                        }
                                                                      }
                                                                    }
                                                                  }
                                                                }
                                                              }
                                                            }
                                                          }
                                                        }
                                                      }
                                                    }
                                                  }
                                                }
                                              }
                                            }
                                          }
                                        }
                                      }
                                    }
                                  }
                                }
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
};

function parseFiles(onProgress) {
  return Curry._2(IO$OptolithClient.Infix.$less$amp$great, parseDirectories(onProgress, dirs), (function (xs) {
                if (xs) {
                  var match = xs.tl;
                  if (match) {
                    var match$1 = match.tl;
                    if (match$1) {
                      var match$2 = match$1.tl;
                      if (match$2) {
                        var match$3 = match$2.tl;
                        if (match$3) {
                          var match$4 = match$3.tl;
                          if (match$4) {
                            var match$5 = match$4.tl;
                            if (match$5) {
                              var match$6 = match$5.tl;
                              if (match$6) {
                                var match$7 = match$6.tl;
                                if (match$7) {
                                  var match$8 = match$7.tl;
                                  if (match$8) {
                                    var match$9 = match$8.tl;
                                    if (match$9) {
                                      var match$10 = match$9.tl;
                                      if (match$10) {
                                        var match$11 = match$10.tl;
                                        if (match$11) {
                                          var match$12 = match$11.tl;
                                          if (match$12) {
                                            var match$13 = match$12.tl;
                                            if (match$13) {
                                              var match$14 = match$13.tl;
                                              if (match$14) {
                                                var match$15 = match$14.tl;
                                                if (match$15) {
                                                  var match$16 = match$15.tl;
                                                  if (match$16) {
                                                    var match$17 = match$16.tl;
                                                    if (match$17) {
                                                      var match$18 = match$17.tl;
                                                      if (match$18) {
                                                        var match$19 = match$18.tl;
                                                        if (match$19) {
                                                          var match$20 = match$19.tl;
                                                          if (match$20) {
                                                            var match$21 = match$20.tl;
                                                            if (match$21) {
                                                              var match$22 = match$21.tl;
                                                              if (match$22) {
                                                                var match$23 = match$22.tl;
                                                                if (match$23) {
                                                                  var match$24 = match$23.tl;
                                                                  if (match$24) {
                                                                    var match$25 = match$24.tl;
                                                                    if (match$25) {
                                                                      var match$26 = match$25.tl;
                                                                      if (match$26) {
                                                                        var match$27 = match$26.tl;
                                                                        if (match$27) {
                                                                          var match$28 = match$27.tl;
                                                                          if (match$28) {
                                                                            var match$29 = match$28.tl;
                                                                            if (match$29) {
                                                                              var match$30 = match$29.tl;
                                                                              if (match$30) {
                                                                                var match$31 = match$30.tl;
                                                                                if (match$31) {
                                                                                  var match$32 = match$31.tl;
                                                                                  if (match$32) {
                                                                                    var match$33 = match$32.tl;
                                                                                    if (match$33) {
                                                                                      var match$34 = match$33.tl;
                                                                                      if (match$34) {
                                                                                        var match$35 = match$34.tl;
                                                                                        if (match$35) {
                                                                                          var match$36 = match$35.tl;
                                                                                          if (match$36) {
                                                                                            var match$37 = match$36.tl;
                                                                                            if (match$37) {
                                                                                              var match$38 = match$37.tl;
                                                                                              if (match$38) {
                                                                                                var match$39 = match$38.tl;
                                                                                                if (match$39) {
                                                                                                  var match$40 = match$39.tl;
                                                                                                  if (match$40) {
                                                                                                    var match$41 = match$40.tl;
                                                                                                    if (match$41) {
                                                                                                      var match$42 = match$41.tl;
                                                                                                      if (match$42) {
                                                                                                        var match$43 = match$42.tl;
                                                                                                        if (match$43) {
                                                                                                          var match$44 = match$43.tl;
                                                                                                          if (match$44) {
                                                                                                            var match$45 = match$44.tl;
                                                                                                            if (match$45) {
                                                                                                              var match$46 = match$45.tl;
                                                                                                              if (match$46) {
                                                                                                                var match$47 = match$46.tl;
                                                                                                                if (match$47) {
                                                                                                                  var match$48 = match$47.tl;
                                                                                                                  if (match$48) {
                                                                                                                    var match$49 = match$48.tl;
                                                                                                                    if (match$49) {
                                                                                                                      var match$50 = match$49.tl;
                                                                                                                      if (match$50) {
                                                                                                                        var match$51 = match$50.tl;
                                                                                                                        if (match$51 && !match$51.tl) {
                                                                                                                          return {
                                                                                                                                  advantages: xs.hd,
                                                                                                                                  animistForces: match.hd,
                                                                                                                                  arcaneBardTraditions: match$1.hd,
                                                                                                                                  arcaneDancerTraditions: match$2.hd,
                                                                                                                                  armorTypes: match$3.hd,
                                                                                                                                  aspects: match$4.hd,
                                                                                                                                  attributes: match$5.hd,
                                                                                                                                  blessedTraditions: match$6.hd,
                                                                                                                                  blessings: match$7.hd,
                                                                                                                                  brews: match$8.hd,
                                                                                                                                  cantrips: match$9.hd,
                                                                                                                                  combatSpecialAbilityGroups: match$10.hd,
                                                                                                                                  combatTechniqueGroups: match$11.hd,
                                                                                                                                  combatTechniques: match$12.hd,
                                                                                                                                  conditions: match$13.hd,
                                                                                                                                  cultures: match$14.hd,
                                                                                                                                  curses: match$15.hd,
                                                                                                                                  derivedCharacteristics: match$16.hd,
                                                                                                                                  disadvantages: match$17.hd,
                                                                                                                                  dominationRituals: match$18.hd,
                                                                                                                                  elvenMagicalSongs: match$19.hd,
                                                                                                                                  items: match$20.hd,
                                                                                                                                  equipmentGroups: match$21.hd,
                                                                                                                                  equipmentPackages: match$22.hd,
                                                                                                                                  experienceLevels: match$23.hd,
                                                                                                                                  eyeColors: match$24.hd,
                                                                                                                                  focusRules: match$25.hd,
                                                                                                                                  geodeRituals: match$26.hd,
                                                                                                                                  hairColors: match$27.hd,
                                                                                                                                  liturgicalChantGroups: match$28.hd,
                                                                                                                                  liturgicalChants: match$29.hd,
                                                                                                                                  magicalDances: match$30.hd,
                                                                                                                                  magicalMelodies: match$31.hd,
                                                                                                                                  magicalTraditions: match$32.hd,
                                                                                                                                  optionalRules: match$33.hd,
                                                                                                                                  pacts: match$34.hd,
                                                                                                                                  professions: match$35.hd,
                                                                                                                                  properties: match$36.hd,
                                                                                                                                  publications: match$37.hd,
                                                                                                                                  races: match$38.hd,
                                                                                                                                  reaches: match$39.hd,
                                                                                                                                  rogueSpells: match$40.hd,
                                                                                                                                  skillGroups: match$41.hd,
                                                                                                                                  skills: match$42.hd,
                                                                                                                                  socialStatuses: match$43.hd,
                                                                                                                                  specialAbilities: match$44.hd,
                                                                                                                                  specialAbilityGroups: match$45.hd,
                                                                                                                                  spellGroups: match$46.hd,
                                                                                                                                  spells: match$47.hd,
                                                                                                                                  states: match$48.hd,
                                                                                                                                  subjects: match$49.hd,
                                                                                                                                  tribes: match$50.hd,
                                                                                                                                  zibiljaRituals: match$51.hd
                                                                                                                                };
                                                                                                                        }
                                                                                                                        
                                                                                                                      }
                                                                                                                      
                                                                                                                    }
                                                                                                                    
                                                                                                                  }
                                                                                                                  
                                                                                                                }
                                                                                                                
                                                                                                              }
                                                                                                              
                                                                                                            }
                                                                                                            
                                                                                                          }
                                                                                                          
                                                                                                        }
                                                                                                        
                                                                                                      }
                                                                                                      
                                                                                                    }
                                                                                                    
                                                                                                  }
                                                                                                  
                                                                                                }
                                                                                                
                                                                                              }
                                                                                              
                                                                                            }
                                                                                            
                                                                                          }
                                                                                          
                                                                                        }
                                                                                        
                                                                                      }
                                                                                      
                                                                                    }
                                                                                    
                                                                                  }
                                                                                  
                                                                                }
                                                                                
                                                                              }
                                                                              
                                                                            }
                                                                            
                                                                          }
                                                                          
                                                                        }
                                                                        
                                                                      }
                                                                      
                                                                    }
                                                                    
                                                                  }
                                                                  
                                                                }
                                                                
                                                              }
                                                              
                                                            }
                                                            
                                                          }
                                                          
                                                        }
                                                        
                                                      }
                                                      
                                                    }
                                                    
                                                  }
                                                  
                                                }
                                                
                                              }
                                              
                                            }
                                            
                                          }
                                          
                                        }
                                        
                                      }
                                      
                                    }
                                    
                                  }
                                  
                                }
                                
                              }
                              
                            }
                            
                          }
                          
                        }
                        
                      }
                      
                    }
                    
                  }
                  
                }
                return Pervasives.failwith("Unexpected length of directories: " + Ley_Int$OptolithClient.show(Curry._1(Ley_List$OptolithClient.length, xs)));
              }));
}

export {
  Parser ,
  parseUI ,
  parseFilesOfEntryType ,
  parseDirectories ,
  dirs ,
  parseFiles ,
  
}
/* path Not a pure module */
